# 请求记录优化案例

一接口，每天请求大概7KW左右，每一条都需要给用户去查询

第一版本

所有记录全写在一个表里面，写入快，查询慢，有的用户可能请求百万次，有的用户可能就几万次，用记做索引辨识度不高

第二版本

根据用户做了日期切割，每位用户每天一张表，写入太慢，大概每秒二千多条的样子，因为不同用户对应的不同的表，硬盘相当于是随机写入，比较慢

第三版本

写个脚本，把所有数据分类写入redis，每个客户数据分类放好，然后mysql在一次性处理1000条，相当于是顺序写入一千条。

这版本速度提升到大约1.5W每秒的样子。基本上能与请求量持平了。